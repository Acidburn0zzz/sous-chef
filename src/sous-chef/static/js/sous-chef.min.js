!function(e){e.fn.formset=function(t){var a=e.extend({},e.fn.formset.defaults,t),i=a.extraClasses.join(" "),n=e("#id_"+a.prefix+"-TOTAL_FORMS"),r=e("#id_"+a.prefix+"-MAX_NUM_FORMS"),s=e("#id_"+a.prefix+"-MIN_NUM_FORMS"),o="input,select,textarea,label,div",l=e(this),d=function(e,t){a.extraClasses&&(e.removeClass(i),e.addClass(a.extraClasses[t%a.extraClasses.length]))},u=function(e,t,a){var i=new RegExp(t+"-(\\d+|__prefix__)-"),n=t+"-"+a+"-";e.attr("for")&&e.attr("for",e.attr("for").replace(i,n)),e.attr("id")&&e.attr("id",e.attr("id").replace(i,n)),e.attr("name")&&e.attr("name",e.attr("name").replace(i,n))},c=function(e){return e.find(o).length>0},f=function(){return 0==r.length||""==r.val()||r.val()-n.val()>0},p=function(){return 0==s.length||""==s.val()||n.val()-s.val()>0},m=function(t){var i=e.trim(a.deleteCssClass).replace(/\s+/g,"."),r=e.trim(a.addCssClass).replace(/\s+/g,".");t.is("TR")?t.children(":last").append('<a class="'+a.deleteCssClass+'" href="javascript:void(0)">'+a.deleteText+"</a>"):t.is("UL")||t.is("OL")?t.append('<li><a class="'+a.deleteCssClass+'" href="javascript:void(0)">'+a.deleteText+"</a></li>"):t.append('<a class="'+a.deleteCssClass+'" href="javascript:void(0)">'+a.deleteText+"</a>"),p()||t.find("a."+i).hide(),t.find("a."+i).click(function(){var t,s=e(this).parents("."+a.formCssClass),l=s.find('input:hidden[id $= "-DELETE"]'),c=s.siblings("a."+r+", ."+a.formCssClass+"-add");l.length?(l.val("on"),s.hide(),t=e("."+a.formCssClass).not(":hidden")):(s.remove(),t=e("."+a.formCssClass).not(".formset-custom-template"),n.val(t.length));for(var m=0,h=t.length;m<h;m++)d(t.eq(m),m),l.length||t.eq(m).find(o).each(function(){u(e(this),a.prefix,m)});return p()||e("a."+i).each(function(){e(this).hide()}),c.is(":hidden")&&f()&&c.show(),a.removed&&a.removed(s),!1})};if(l.each(function(t){var i=e(this),n=i.find('input:checkbox[id $= "-DELETE"]');n.length&&(n.is(":checked")?(n.before('<input type="hidden" name="'+n.attr("name")+'" id="'+n.attr("id")+'" value="on" />'),i.hide()):n.before('<input type="hidden" name="'+n.attr("name")+'" id="'+n.attr("id")+'" />'),e('label[for="'+n.attr("id")+'"]').hide(),n.remove()),c(i)&&(i.addClass(a.formCssClass),i.is(":visible")&&(m(i),d(i,t)))}),l.length){var h,g,D=!f();if(a.formTemplate?(g=a.formTemplate instanceof e?a.formTemplate:e(a.formTemplate),g.removeAttr("id").addClass(a.formCssClass+" formset-custom-template"),g.find(o).each(function(){u(e(this),a.prefix,"__prefix__")}),m(g)):(g=e("."+a.formCssClass+":last").clone(!0).removeAttr("id"),g.find('input:hidden[id $= "-DELETE"]').remove(),g.find(o).not(a.keepFieldValues).each(function(){var t=e(this);t.is("input:checkbox")||t.is("input:radio")?t.attr("checked",!1):t.val("")})),a.formTemplate=g,l.is("TR")){var v=l.eq(0).children().length,y=e('<tr><td colspan="'+v+'"><a class="'+a.addCssClass+'" href="javascript:void(0)">'+a.addText+"</a></tr>").addClass(a.formCssClass+"-add");l.parent().append(y),D&&y.hide(),h=y.find("a")}else l.filter(":last").after('<a class="'+a.addCssClass+'" href="javascript:void(0)">'+a.addText+"</a>"),h=l.filter(":last").next(),D&&h.hide();h.click(function(){var t=parseInt(n.val()),i=a.formTemplate.clone(!0).removeClass("formset-custom-template"),r=e(e(this).parents("tr."+a.formCssClass+"-add").get(0)||this);return delCssSelector=e.trim(a.deleteCssClass).replace(/\s+/g,"."),d(i,t),i.insertBefore(r).show(),i.find(o).each(function(){u(e(this),a.prefix,t)}),n.val(t+1),p()&&e("a."+delCssSelector).each(function(){e(this).show()}),f()||r.hide(),a.added&&a.added(i),!1})}return l},e.fn.formset.defaults={prefix:"form",formTemplate:null,addText:"add another",deleteText:"remove",addCssClass:"add-row",deleteCssClass:"delete-row",formCssClass:"dynamic-form",extraClasses:[],keepFieldValues:"",added:null,removed:null}}(jQuery),!function(e){e.tablesort=function(t,a){var i=this;this.$table=t,this.$thead=this.$table.find("thead"),this.settings=e.extend({},e.tablesort.defaults,a),this.$sortCells=this.$thead.length>0?this.$thead.find("th:not(.no-sort)"):this.$table.find("th:not(.no-sort)"),this.$sortCells.bind("click.tablesort",function(){i.sort(e(this))}),this.index=null,this.$th=null,this.direction=null},e.tablesort.prototype={sort:function(t,a){var i=new Date,n=this,r=this.$table,s=this.$thead.length>0?r.find("tbody tr"):r.find("tr").has("td"),o=r.find("tr td:nth-of-type("+(t.index()+1)+")"),l=t.data().sortBy,d=[],u=o.map(function(a,i){return l?"function"==typeof l?l(e(t),e(i),n):l:null!=e(this).data().sortValue?e(this).data().sortValue:e(this).text()});0!==u.length&&("asc"!==a&&"desc"!==a?this.direction="asc"===this.direction?"desc":"asc":this.direction=a,a="asc"==this.direction?1:-1,n.$table.trigger("tablesort:start",[n]),n.log("Sorting by "+this.index+" "+this.direction),n.$table.css("display"),setTimeout(function(){n.$sortCells.removeClass(n.settings.asc+" "+n.settings.desc);for(var l=0,c=u.length;c>l;l++)d.push({index:l,cell:o[l],row:s[l],value:u[l]});d.sort(function(e,t){return e.value>t.value?1*a:e.value<t.value?-1*a:0}),e.each(d,function(e,t){r.append(t.row)}),t.addClass(n.settings[n.direction]),n.log("Sort finished in "+((new Date).getTime()-i.getTime())+"ms"),n.$table.trigger("tablesort:complete",[n]),n.$table.css("display")},u.length>2e3?200:10))},log:function(t){(e.tablesort.DEBUG||this.settings.debug)&&console&&console.log&&console.log("[tablesort] "+t)},destroy:function(){return this.$sortCells.unbind("click.tablesort"),this.$table.data("tablesort",null),null}},e.tablesort.DEBUG=!1,e.tablesort.defaults={debug:e.tablesort.DEBUG,asc:"sorted ascending",desc:"sorted descending"},e.fn.tablesort=function(t){var a,i;return this.each(function(){a=e(this),i=a.data("tablesort"),i&&i.destroy(),a.data("tablesort",new e.tablesort(a,t))})}}(window.Zepto||window.jQuery),!function(e,t,a,i){e.fn.calendar=function(t){var n,r=e(this),s=r.selector||"",o=(new Date).getTime(),l=[],d=arguments[0],u="string"==typeof d,c=[].slice.call(arguments,1);return r.each(function(){var r,f,p=e.isPlainObject(t)?e.extend(!0,{},e.fn.calendar.settings,t):e.extend({},e.fn.calendar.settings),m=p.className,h=p.namespace,g=p.selector,D=p.formatter,v=p.parser,y=p.metadata,b=p.error,k="."+h,C="module-"+h,w=e(this),$=w.find(g.input),_=w.find(g.popup),x=w.find(g.activator),P=this,T=w.data(C),M=!1,j=!1;f={initialize:function(){f.debug("Initializing calendar for",P),r=f.get.isTouch(),f.setup.popup(),f.setup.inline(),f.setup.input(),f.setup.date(),f.create.calendar(),f.bind.events(),f.instantiate()},instantiate:function(){f.verbose("Storing instance of calendar"),T=f,w.data(C,T)},destroy:function(){f.verbose("Destroying previous calendar for",P),w.removeData(C),f.unbind.events()},setup:{popup:function(){if(!p.inline&&(x.length||(x=w.children().first(),x.length))){if(e.fn.popup===i)return void f.error(b.popup);_.length||(_=e("<div/>").addClass(m.popup).prependTo(x.parent())),_.addClass(m.calendar);var t=p.onVisible,a=p.onHidden;$.length||(_.attr("tabindex","0"),t=function(){return f.focus(),p.onVisible.apply(_,arguments)},a=function(){return f.blur(),p.onHidden.apply(_,arguments)});var n=function(){return f.set.focusDate(f.get.date()),f.set.mode(p.startMode),p.onShow.apply(_,arguments)},r=p.on||($.length?"focus":"click"),s=e.extend({},p.popupOptions,{popup:_,on:r,hoverable:"hover"===r,onShow:n,onVisible:t,onHide:p.onHide,onHidden:a});f.popup(s)}},inline:function(){(!x.length||p.inline)&&(_=e("<div/>").addClass(m.calendar).appendTo(w),$.length||_.attr("tabindex","0"))},input:function(){p.touchReadonly&&$.length&&r&&$.prop("readonly",!0)},date:function(){if($.length){var e=$.val(),t=v.date(e,p);f.set.date(t,p.formatInput,!1)}}},create:{calendar:function(){var t,a,i,n,r,s=f.get.mode(),o=new Date,l=f.get.date(),d=f.get.focusDate(),u=d||l||p.initialDate||o;u=f.helper.dateInRange(u),d||(d=u,f.set.focusDate(d,!1,!1));var c=u.getMinutes(),h=u.getHours(),g=u.getDate(),v=u.getMonth(),b=u.getFullYear(),k="year"===s,C="month"===s,w="day"===s,$="hour"===s,x="minute"===s,P="time"===p.type,T=w?7:$?4:3,M=7===T?"seven":4===T?"four":"three",j=w||$?6:4,F=(new Date(b,v,1).getDay()-p.firstDayOfWeek%7+7)%7;if(!p.constantHeight&&w){var S=new Date(b,v+1,0).getDate()+F;j=Math.ceil(S/7)}var R=k?10:C?1:0,E=w?1:0,O=$||x?1:0,I=$||x?g:1,q=new Date(b-R,v-E,I-O,h),N=new Date(b+R,v+E,I+O,h),H=k?new Date(10*Math.ceil(b/10)-9,0,0):C?new Date(b,0,0):w?new Date(b,v,0):new Date(b,v,g,(-1)),A=k?new Date(10*Math.ceil(b/10)+1,0,1):C?new Date(b+1,0,1):w?new Date(b,v+1,1):new Date(b,v,g+1),Y=e("<table/>").addClass(m.table).addClass(M+" column").addClass(s);if(!P){var V=e("<thead/>").appendTo(Y);n=e("<tr/>").appendTo(V),r=e("<th/>").attr("colspan",""+T).appendTo(n);var B=e("<span/>").addClass(m.link).appendTo(r);B.text(D.header(u,s,p));var L=C?p.disableYear?"day":"year":w?p.disableMonth?"year":"month":"day";B.data(y.mode,L);var z=e("<span/>").addClass(m.prev).appendTo(r);z.data(y.focusDate,q),z.toggleClass(m.disabledCell,!f.helper.isDateInRange(H,s)),e("<i/>").addClass(m.prevIcon).appendTo(z);var Q=e("<span/>").addClass(m.next).appendTo(r);if(Q.data(y.focusDate,N),Q.toggleClass(m.disabledCell,!f.helper.isDateInRange(A,s)),e("<i/>").addClass(m.nextIcon).appendTo(Q),w)for(n=e("<tr/>").appendTo(V),t=0;T>t;t++)r=e("<th/>").appendTo(n),r.text(D.dayColumnHeader((t+p.firstDayOfWeek)%7,p))}var U=e("<tbody/>").appendTo(Y);for(t=k?10*Math.ceil(b/10)-9:w?1-F:0,a=0;j>a;a++)for(n=e("<tr/>").appendTo(U),i=0;T>i;i++,t++){var J=k?new Date(t,v,1,h,c):C?new Date(b,t,1,h,c):w?new Date(b,v,t,h,c):$?new Date(b,v,g,t):new Date(b,v,g,h,5*t),K=k?t:C?p.text.monthsShort[t]:w?J.getDate():D.time(J,p,!0);r=e("<td/>").addClass(m.cell).appendTo(n),r.text(K),r.data(y.date,J);var W=w&&J.getMonth()!==v||!f.helper.isDateInRange(J,s),G=f.helper.dateEqual(J,l,s);r.toggleClass(m.disabledCell,W),r.toggleClass(m.activeCell,G),$||x||r.toggleClass(m.todayCell,f.helper.dateEqual(J,o,s)),f.helper.dateEqual(J,d,s)&&f.set.focusDate(J,!1,!1)}if(p.today){var Z=e("<tr/>").appendTo(U),X=e("<td/>").attr("colspan",""+T).addClass(m.today).appendTo(Z);X.text(D.today(p)),X.data(y.date,o)}f.update.focus(!1,Y),_.empty(),Y.appendTo(_)}},update:{focus:function(t,a){a=a||_;var i=f.get.mode(),n=f.get.date(),s=f.get.focusDate(),o=f.get.startDate(),l=f.get.endDate(),d=(t?s:null)||n||(r?null:s);a.find("td").each(function(){var t=e(this),a=t.data(y.date);if(a){var n=t.hasClass(m.disabledCell),u=t.hasClass(m.activeCell),c=f.helper.dateEqual(a,s,i),p=!!d&&(!!o&&f.helper.isDateInRange(a,i,o,d)||!!l&&f.helper.isDateInRange(a,i,d,l));t.toggleClass(m.focusCell,c&&(!r||M)),t.toggleClass(m.rangeCell,p&&!u&&!n)}})}},refresh:function(){f.create.calendar()},bind:{events:function(){_.on("mousedown"+k,f.event.mousedown),_.on("touchstart"+k,f.event.mousedown),_.on("mouseup"+k,f.event.mouseup),_.on("touchend"+k,f.event.mouseup),_.on("mouseover"+k,f.event.mouseover),$.length?($.on("input"+k,f.event.inputChange),$.on("focus"+k,f.event.inputFocus),$.on("blur"+k,f.event.inputBlur),$.on("click"+k,f.event.inputClick),$.on("keydown"+k,f.event.keydown)):_.on("keydown"+k,f.event.keydown)}},unbind:{events:function(){_.off(k),$.length&&$.off(k)}},event:{mouseover:function(t){var a=e(t.target),i=a.data(y.date),n=1===t.buttons;i&&f.set.focusDate(i,!1,!0,n)},mousedown:function(t){$.length&&t.preventDefault(),M=t.type.indexOf("touch")>=0;var a=e(t.target),i=a.data(y.date);i&&f.set.focusDate(i,!1,!0,!0)},mouseup:function(t){f.focus(),t.preventDefault(),t.stopPropagation(),M=!1;var a=e(t.target),i=a.parent();(i.data(y.date)||i.data(y.focusDate)||i.data(y.mode))&&(a=i);var n=a.data(y.date),r=a.data(y.focusDate),s=a.data(y.mode);if(n){var o=a.hasClass(m.today);f.selectDate(n,o)}else r?f.set.focusDate(r):s&&f.set.mode(s)},keydown:function(e){if((27===e.keyCode||9===e.keyCode)&&f.popup("hide"),f.popup("is visible"))if(37===e.keyCode||38===e.keyCode||39===e.keyCode||40===e.keyCode){var t=f.get.mode(),a="day"===t?7:"hour"===t?4:3,i=37===e.keyCode?-1:38===e.keyCode?-a:39==e.keyCode?1:a;i*="minute"===t?5:1;var n=f.get.focusDate()||f.get.date()||new Date,r=n.getFullYear()+("year"===t?i:0),s=n.getMonth()+("month"===t?i:0),o=n.getDate()+("day"===t?i:0),l=n.getHours()+("hour"===t?i:0),d=n.getMinutes()+("minute"===t?i:0),u=new Date(r,s,o,l,d);"time"===p.type&&(u=f.helper.mergeDateTime(n,u)),f.helper.isDateInRange(u,t)&&f.set.focusDate(u)}else if(13===e.keyCode){var c=f.get.focusDate();c&&f.selectDate(c)}(38===e.keyCode||40===e.keyCode)&&(e.preventDefault(),f.popup("show"))},inputChange:function(){var e=$.val(),t=v.date(e,p);f.set.date(t,!1)},inputFocus:function(){_.addClass(m.active)},inputBlur:function(){if(_.removeClass(m.active),p.formatInput){var e=f.get.date(),t=D.datetime(e,p);$.val(t)}},inputClick:function(){f.popup("show")}},get:{date:function(){return w.data(y.date)||null},focusDate:function(){return w.data(y.focusDate)||null},startDate:function(){var e=f.get.calendarModule(p.startCalendar);return(e?e.get.date():w.data(y.startDate))||null},endDate:function(){var e=f.get.calendarModule(p.endCalendar);return(e?e.get.date():w.data(y.endDate))||null},mode:function(){var t=w.data(y.mode)||p.startMode,a=f.get.validModes();return e.inArray(t,a)>=0?t:"time"===p.type?"hour":"month"===p.type?"month":"year"===p.type?"year":"day"},validModes:function(){var e=[];return"time"!==p.type&&(p.disableYear&&"year"!==p.type||e.push("year"),(!p.disableMonth&&"year"!==p.type||"month"===p.type)&&e.push("month"),p.type.indexOf("date")>=0&&e.push("day")),p.type.indexOf("time")>=0&&(e.push("hour"),p.disableMinute||e.push("minute")),e},isTouch:function(){try{return a.createEvent("TouchEvent"),!0}catch(e){return!1}},calendarModule:function(t){return t?(t instanceof e||(t=w.parent().children(t).first()),t.data(C)):null}},set:{date:function(e,t,a){t=t!==!1,a=a!==!1,e=f.helper.sanitiseDate(e),e=f.helper.dateInRange(e);var n=D.datetime(e,p);if(a&&p.onChange.call(P,e,n)===!1)return!1;var r=f.get.endDate();r&&e&&e>r&&f.set.endDate(i),f.set.dataKeyValue(y.date,e),f.set.focusDate(e),t&&$.length&&$.val(n)},startDate:function(e,t){e=f.helper.sanitiseDate(e);var a=f.get.calendarModule(p.startCalendar);a&&a.set.date(e),f.set.dataKeyValue(y.startDate,e,t)},endDate:function(e,t){e=f.helper.sanitiseDate(e);var a=f.get.calendarModule(p.endCalendar);a&&a.set.date(e),f.set.dataKeyValue(y.endDate,e,t)},focusDate:function(e,t,a,i){e=f.helper.sanitiseDate(e),e=f.helper.dateInRange(e);var n=f.set.dataKeyValue(y.focusDate,e,t);a=a!==!1&&n&&t===!1||j!=i,j=i,a&&f.update.focus(i)},mode:function(e,t){f.set.dataKeyValue(y.mode,e,t)},dataKeyValue:function(e,t,a){var i=w.data(e),n=i===t||t>=i&&i>=t;return t?w.data(e,t):w.removeData(e),a=a!==!1&&!n,a&&f.create.calendar(),!n}},selectDate:function(e,t){var a=f.get.mode(),i=t||"minute"===a||p.disableMinute&&"hour"===a||"date"===p.type&&"day"===a||"month"===p.type&&"month"===a||"year"===p.type&&"year"===a;if(i){var n=f.set.date(e)===!1;if(!n&&p.closable){f.popup("hide");var r=f.get.calendarModule(p.endCalendar);r&&(r.popup("show"),r.focus())}}else{var s="year"===a?p.disableMonth?"day":"month":"month"===a?"day":"day"===a?"hour":"minute";f.set.mode(s),"hour"===a||"day"===a&&f.get.date()?f.set.date(e):f.set.focusDate(e)}},changeDate:function(e){f.set.date(e)},clear:function(){f.set.date(i)},popup:function(){return x.popup.apply(x,arguments)},focus:function(){$.length?$.focus():_.focus()},blur:function(){$.length?$.blur():_.blur()},helper:{sanitiseDate:function(e){return e?(e instanceof Date||(e=v.date(""+e)),isNaN(e.getTime())?i:e):i},dateDiff:function(e,t,a){a=a||"day";var i="time"===p.type,n="year"===a,r=n||"month"===a,s="minute"===a,o=s||"hour"===a;return e=new Date(i?2e3:e.getFullYear(),i?0:n?0:e.getMonth(),i?1:r?1:e.getDate(),o?e.getHours():0,s?Math.floor(e.getMinutes()/5):0),t=new Date(i?2e3:t.getFullYear(),i?0:n?0:t.getMonth(),i?1:r?1:t.getDate(),o?t.getHours():0,s?Math.floor(t.getMinutes()/5):0),t.getTime()-e.getTime()},dateEqual:function(e,t,a){return!!e&&!!t&&0===f.helper.dateDiff(e,t,a)},isDateInRange:function(e,t,a,i){if(!a&&!i){var n=f.get.startDate();a=n&&p.minDate?Math.max(n,p.minDate):n||p.minDate,i=p.maxDate}return!(!e||a&&f.helper.dateDiff(e,a,t)>0||i&&f.helper.dateDiff(i,e,t)>0)},dateInRange:function(e,t,a){if(!t&&!a){var i=f.get.startDate();t=i&&p.minDate?Math.max(i,p.minDate):i||p.minDate,a=p.maxDate}var n="time"===p.type;return e?t&&f.helper.dateDiff(e,t,"minute")>0?n?f.helper.mergeDateTime(e,t):t:a&&f.helper.dateDiff(a,e,"minute")>0?n?f.helper.mergeDateTime(e,a):a:e:e},mergeDateTime:function(e,t){return e&&t?new Date(e.getFullYear(),e.getMonth(),e.getDate(),t.getHours(),t.getMinutes()):t}},setting:function(t,a){if(f.debug("Changing setting",t,a),e.isPlainObject(t))e.extend(!0,p,t);else{if(a===i)return p[t];p[t]=a}},internal:function(t,a){if(e.isPlainObject(t))e.extend(!0,f,t);else{if(a===i)return f[t];f[t]=a}},debug:function(){p.debug&&(p.performance?f.performance.log(arguments):(f.debug=Function.prototype.bind.call(console.info,console,p.name+":"),f.debug.apply(console,arguments)))},verbose:function(){p.verbose&&p.debug&&(p.performance?f.performance.log(arguments):(f.verbose=Function.prototype.bind.call(console.info,console,p.name+":"),f.verbose.apply(console,arguments)))},error:function(){f.error=Function.prototype.bind.call(console.error,console,p.name+":"),f.error.apply(console,arguments)},performance:{log:function(e){var t,a,i;p.performance&&(t=(new Date).getTime(),i=o||t,a=t-i,o=t,l.push({Name:e[0],Arguments:[].slice.call(e,1)||"",Element:P,"Execution Time":a})),clearTimeout(f.performance.timer),f.performance.timer=setTimeout(f.performance.display,500)},display:function(){var t=p.name+":",a=0;o=!1,clearTimeout(f.performance.timer),e.each(l,function(e,t){a+=t["Execution Time"]}),t+=" "+a+"ms",s&&(t+=" '"+s+"'"),(console.group!==i||console.table!==i)&&l.length>0&&(console.groupCollapsed(t),console.table?console.table(l):e.each(l,function(e,t){console.log(t.Name+": "+t["Execution Time"]+"ms")}),console.groupEnd()),l=[]}},invoke:function(t,a,r){var s,o,l,d=T;return a=a||c,r=P||r,"string"==typeof t&&d!==i&&(t=t.split(/[\. ]/),s=t.length-1,e.each(t,function(a,n){var r=a!=s?n+t[a+1].charAt(0).toUpperCase()+t[a+1].slice(1):t;if(e.isPlainObject(d[r])&&a!=s)d=d[r];else{if(d[r]!==i)return o=d[r],!1;if(!e.isPlainObject(d[n])||a==s)return d[n]!==i?(o=d[n],!1):(f.error(b.method,t),!1);d=d[n]}})),e.isFunction(o)?l=o.apply(r,a):o!==i&&(l=o),e.isArray(n)?n.push(l):n!==i?n=[n,l]:l!==i&&(n=l),o}},u?(T===i&&f.initialize(),f.invoke(d)):(T!==i&&T.invoke("destroy"),f.initialize())}),n!==i?n:r},e.fn.calendar.settings={name:"Calendar",namespace:"calendar",debug:!1,verbose:!1,performance:!1,type:"datetime",firstDayOfWeek:0,constantHeight:!0,today:!1,closable:!0,monthFirst:!0,touchReadonly:!0,inline:!1,on:null,initialDate:null,startMode:!1,minDate:null,maxDate:null,ampm:!0,disableYear:!1,disableMonth:!1,disableMinute:!1,formatInput:!0,startCalendar:null,endCalendar:null,popupOptions:{position:"bottom left",lastResort:"bottom left",prefer:"opposite",hideOnScroll:!1},text:{days:["S","M","T","W","T","F","S"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],today:"Today",now:"Now",am:"AM",pm:"PM"},formatter:{header:function(e,t,a){return"year"===t?a.formatter.yearHeader(e,a):"month"===t?a.formatter.monthHeader(e,a):"day"===t?a.formatter.dayHeader(e,a):"hour"===t?a.formatter.hourHeader(e,a):a.formatter.minuteHeader(e,a)},yearHeader:function(e,t){var a=10*Math.ceil(e.getFullYear()/10);return a-9+" - "+(a+2)},monthHeader:function(e,t){return e.getFullYear()},dayHeader:function(e,t){var a=t.text.months[e.getMonth()],i=e.getFullYear();return a+" "+i},hourHeader:function(e,t){return t.formatter.date(e,t)},minuteHeader:function(e,t){return t.formatter.date(e,t)},dayColumnHeader:function(e,t){return t.text.days[e]},datetime:function(e,t){if(!e)return"";var a="time"===t.type?"":t.formatter.date(e,t),i=t.type.indexOf("time")<0?"":t.formatter.time(e,t,!1),n="datetime"===t.type?" ":"";return a+n+i},date:function(e,t){if(!e)return"";var a=e.getDate(),i=t.text.months[e.getMonth()],n=e.getFullYear();return"year"===t.type?n:"month"===t.type?i+" "+n:(t.monthFirst?i+" "+a:a+" "+i)+", "+n},time:function(e,t,a){if(!e)return"";var i=e.getHours(),n=e.getMinutes(),r="";return t.ampm&&(r=" "+(12>i?t.text.am:t.text.pm),i=0===i?12:i>12?i-12:i),i+":"+(10>n?"0":"")+n+r},today:function(e){return"date"===e.type?e.text.today:e.text.now}},parser:{date:function(t,a){if(!t)return null;if(t=(""+t).trim().toLowerCase(),0===t.length)return null;var n,r,s,o=-1,l=-1,d=-1,u=-1,c=-1,f=i,p="time"===a.type,m=a.type.indexOf("time")<0,h=t.split(a.regExp.dateWords),g=t.split(a.regExp.dateNumbers);if(!m)for(f=e.inArray(a.text.am.toLowerCase(),h)>=0||!(e.inArray(a.text.pm.toLowerCase(),h)>=0)&&i,n=0;n<g.length;n++){var D=g[n];if(D.indexOf(":")>=0){if(0>l||0>o){var v=D.split(":");for(s=0;s<Math.min(2,v.length);s++)r=parseInt(v[s]),isNaN(r)&&(r=0),0===s?l=r%24:o=r%60}g.splice(n,1)}}if(!p){for(n=0;n<h.length;n++){var y=h[n];if(!(y.length<=0)){for(y=y.substring(0,Math.min(y.length,3)),r=0;r<a.text.months.length;r++){var b=a.text.months[r];if(b=b.substring(0,Math.min(y.length,Math.min(b.length,3))).toLowerCase(),b===y){u=r+1;break}}if(u>=0)break}}for(n=0;n<g.length;n++)if(r=parseInt(g[n]),!isNaN(r)&&r>59){c=r,g.splice(n,1);break}if(0>u)for(n=0;n<g.length;n++)if(s=n>1||a.monthFirst?n:1===n?0:1,r=parseInt(g[s]),!isNaN(r)&&r>=1&&12>=r){u=r,g.splice(s,1);break}for(n=0;n<g.length;n++)if(r=parseInt(g[n]),!isNaN(r)&&r>=1&&31>=r){d=r,g.splice(n,1);break}if(0>c)for(n=g.length-1;n>=0;n--)if(r=parseInt(g[n]),!isNaN(r)){99>r&&(r+=2e3),c=r,g.splice(n,1);break}}if(!m){if(0>l)for(n=0;n<g.length;n++)if(r=parseInt(g[n]),!isNaN(r)&&r>=0&&23>=r){l=r,g.splice(n,1);break}if(0>o)for(n=0;n<g.length;n++)if(r=parseInt(g[n]),!isNaN(r)&&r>=0&&59>=r){o=r,g.splice(n,1);break}}if(0>o&&0>l&&0>d&&0>u&&0>c)return null;0>o&&(o=0),0>l&&(l=0),0>d&&(d=1),0>u&&(u=1),0>c&&(c=(new Date).getFullYear()),f!==i&&(f?12===l&&(l=0):12>l&&(l+=12));var k=new Date(c,u-1,d,l,o);return(k.getMonth()!==u-1||k.getFullYear()!==c)&&(k=new Date(c,u,0,l,o)),isNaN(k.getTime())?null:k}},onChange:function(e,t){return!0},onShow:function(){},onVisible:function(){},onHide:function(){},onHidden:function(){},selector:{popup:".ui.popup",input:"input",activator:"input"},regExp:{dateWords:/[^A-Za-z\u00C0-\u024F]+/g,dateNumbers:/[^\d:]+/g},error:{popup:"UI Popup, a required component is not included in this page",method:"The method you called is not defined."},className:{calendar:"calendar",active:"active",popup:"ui popup",table:"ui celled center aligned unstackable table",prev:"prev link",next:"next link",prevIcon:"chevron left icon",nextIcon:"chevron right icon",link:"link",cell:"link",disabledCell:"disabled",activeCell:"active",rangeCell:"range",focusCell:"focus",todayCell:"today",today:"today link"},metadata:{date:"date",focusDate:"focusDate",startDate:"startDate",endDate:"endDate",mode:"mode"}}}(jQuery,window,document),function(e){e.extend(e.ui,{multiDatesPicker:{version:"1.6.4"}}),e.fn.multiDatesPicker=function(t){function a(e,t){t||(t="picked"),e=s.call(this,e);for(var a=0;a<this.multiDatesPicker.dates[t].length;a++)if(!u.compareDates(this.multiDatesPicker.dates[t][a],e))return this.multiDatesPicker.dates[t].splice(a,1).pop()}function i(e,t){return t||(t="picked"),this.multiDatesPicker.dates[t].splice(e,1).pop()}function n(e,t,a){t||(t="picked"),e=s.call(this,e),e.setHours(0),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0),u.gotDate.call(this,e,t)===!1&&(this.multiDatesPicker.dates[t].push(e),a||this.multiDatesPicker.dates[t].sort(u.compareDates))}function r(e){e||(e="picked"),this.multiDatesPicker.dates[e].sort(u.compareDates)}function s(e,t,a){return t||(t="object"),u.dateConvert.call(this,e,t,a)}var o=arguments,l=this,d=(new Date,new Date(0),{}),u={init:function(t){var a=e(this);this.multiDatesPicker.changed=!1;var i={beforeShow:function(e,t){this.multiDatesPicker.changed=!1,this.multiDatesPicker.originalBeforeShow&&this.multiDatesPicker.originalBeforeShow.call(this,e,t)},onSelect:function(t,a){var i=e(this);if(this.multiDatesPicker.changed=!0,t&&(i.multiDatesPicker("toggleDate",t),this.multiDatesPicker.changed=!0),"normal"==this.multiDatesPicker.mode&&this.multiDatesPicker.pickableRange)if(this.multiDatesPicker.dates.picked.length>0){var n=this.multiDatesPicker.dates.picked[0],r=new Date(n.getTime());if(u.sumDays(r,this.multiDatesPicker.pickableRange-1),this.multiDatesPicker.adjustRangeToDisabled){var s,o=this.multiDatesPicker.dates.disabled.slice(0);do{s=0;for(var l=0;l<o.length;l++)o[l].getTime()<=r.getTime()&&(n.getTime()<=o[l].getTime()&&o[l].getTime()<=r.getTime()&&s++,o.splice(l,1),l--);r.setDate(r.getDate()+s)}while(0!=s)}this.multiDatesPicker.maxDate&&r>this.multiDatesPicker.maxDate&&(r=this.multiDatesPicker.maxDate),i.datepicker("option","minDate",n).datepicker("option","maxDate",r)}else i.datepicker("option","minDate",this.multiDatesPicker.minDate).datepicker("option","maxDate",this.multiDatesPicker.maxDate);this.multiDatesPicker.originalOnSelect&&t&&this.multiDatesPicker.originalOnSelect.call(this,t,a)},beforeShowDay:function(t){var a=e(this),i=a.multiDatesPicker("gotDate",t)!==!1,n=a.datepicker("option","disabled"),r=a.multiDatesPicker("gotDate",t,"disabled")!==!1,s=this.multiDatesPicker.maxPicks<=this.multiDatesPicker.dates.picked.length,o=[!0,"",null];return this.multiDatesPicker.originalBeforeShowDay&&(o=this.multiDatesPicker.originalBeforeShowDay.call(this,t)),o[1]=i?"ui-state-highlight "+o[1]:o[1],o[0]=o[0]&&!(n||r||s&&!o[1]),o}};if(a.val())var n=a.val();t?(t.separator&&(this.multiDatesPicker.separator=t.separator),this.multiDatesPicker.separator||(this.multiDatesPicker.separator=", "),this.multiDatesPicker.originalBeforeShow=t.beforeShow,this.multiDatesPicker.originalOnSelect=t.onSelect,this.multiDatesPicker.originalBeforeShowDay=t.beforeShowDay,this.multiDatesPicker.originalOnClose=t.onClose,a.datepicker(t),this.multiDatesPicker.minDate=e.datepicker._determineDate(this,t.minDate,null),this.multiDatesPicker.maxDate=e.datepicker._determineDate(this,t.maxDate,null),t.addDates&&u.addDates.call(this,t.addDates),t.addDisabledDates&&u.addDates.call(this,t.addDisabledDates,"disabled"),u.setMode.call(this,t)):a.datepicker(),a.datepicker("option",i),n&&a.multiDatesPicker("value",n);var r=a.multiDatesPicker("value");a.val(r);var s=a.datepicker("option","altField");s&&e(s).val(r),a.datepicker("refresh")},compareDates:function(e,t){e=s.call(this,e),t=s.call(this,t);var a=e.getFullYear()-t.getFullYear();return a||(a=e.getMonth()-t.getMonth(),a||(a=e.getDate()-t.getDate())),a},sumDays:function(e,t){var a=typeof e;return obj_date=s.call(this,e),obj_date.setDate(obj_date.getDate()+t),s.call(this,obj_date,a)},dateConvert:function(t,a,i){var n=typeof t,r=e(this);if(n==a){if("object"==n)try{t.getTime()}catch(s){return e.error("Received date is in a non supported format!"),!1}return t}if("undefined"==typeof t&&(t=new Date(0)),"string"!=a&&"object"!=a&&"number"!=a&&e.error('Date format "'+a+'" not supported!'),!i){var o=r.datepicker("option","dateFormat");i=o?o:e.datepicker._defaults.dateFormat}switch(n){case"object":break;case"string":t=e.datepicker.parseDate(i,t);break;case"number":t=new Date(t);break;default:e.error('Conversion from "'+a+'" format not allowed on jQuery.multiDatesPicker')}switch(a){case"object":return t;case"string":return e.datepicker.formatDate(i,t);case"number":return t.getTime();default:e.error('Conversion to "'+a+'" format not allowed on jQuery.multiDatesPicker')}return!1},gotDate:function(e,t){t||(t="picked");for(var a=0;a<this.multiDatesPicker.dates[t].length;a++)if(0===u.compareDates.call(this,this.multiDatesPicker.dates[t][a],e))return a;return!1},value:function(e){if(!e||"string"!=typeof e){var t=u.getDates.call(this,"string");return t.length?t.join(this.multiDatesPicker.separator):""}u.addDates.call(this,e.split(this.multiDatesPicker.separator))},getDates:function(t,a){switch(t||(t="string"),a||(a="picked"),t){case"object":return this.multiDatesPicker.dates[a];case"string":case"number":var i=new Array;for(var n in this.multiDatesPicker.dates[a])i.push(s.call(this,this.multiDatesPicker.dates[a][n],t));return i;default:e.error('Format "'+t+'" not supported!')}},addDates:function(t,a){if(t.length>0)switch(a||(a="picked"),typeof t){case"object":case"array":if(t.length){for(var i=0;i<t.length;i++)n.call(this,t[i],a,!0);r.call(this,a);break}case"string":case"number":n.call(this,t,a);break;default:e.error('Date format "'+typeof t+'" not allowed on jQuery.multiDatesPicker')}else e.error("Empty array of dates received.")},removeDates:function(e,t){t||(t="picked");var i=[];if("[object Array]"===Object.prototype.toString.call(e))for(var n in e.sort(function(e,t){return t-e}))i.push(a.call(this,e[n],t));else i.push(a.call(this,e,t));return i},removeIndexes:function(e,t){t||(t="picked");var a=[];if("[object Array]"===Object.prototype.toString.call(e))for(var n in e.sort(function(e,t){return t-e}))a.push(i.call(this,e[n],t));else a.push(i.call(this,e,t));return a},resetDates:function(e){e||(e="picked"),this.multiDatesPicker.dates[e]=[]},toggleDate:function(e,t){switch(t||(t="picked"),this.multiDatesPicker.mode){case"daysRange":this.multiDatesPicker.dates[t]=[];var a=this.multiDatesPicker.autoselectRange[1],i=this.multiDatesPicker.autoselectRange[0];a<i&&(a=this.multiDatesPicker.autoselectRange[0],i=this.multiDatesPicker.autoselectRange[1]);for(var n=i;n<a;n++)u.addDates.call(this,u.sumDays.call(this,e,n),t);break;default:u.gotDate.call(this,e)===!1?u.addDates.call(this,e,t):u.removeDates.call(this,e,t)}},setMode:function(t){e(this);switch(t.mode&&(this.multiDatesPicker.mode=t.mode),this.multiDatesPicker.mode){case"normal":for(option in t)switch(option){case"maxPicks":case"minPicks":case"pickableRange":case"adjustRangeToDisabled":this.multiDatesPicker[option]=t[option]}break;case"daysRange":case"weeksRange":var a=1;for(option in t)switch(option){case"autoselectRange":a--;case"pickableRange":case"adjustRangeToDisabled":this.multiDatesPicker[option]=t[option]}a>0&&e.error("Some mandatory options not specified!")}d.onSelect&&d.onSelect()},destroy:function(){this.multiDatesPicker=null,e(this).datepicker("destroy")}};return this.each(function(){var a=e(this);if(this.multiDatesPicker||(this.multiDatesPicker={dates:{picked:[],disabled:[]},mode:"normal",adjustRangeToDisabled:!0}),u[t]){var i=u[t].apply(this,Array.prototype.slice.call(o,1));switch(t){case"removeDates":case"removeIndexes":case"resetDates":case"toggleDate":case"addDates":var n=a.datepicker("option","altField"),r=u.value.call(this);void 0!==n&&""!=n&&e(n).val(r),a.val(r),e.datepicker._refreshDatepicker(this)}switch(t){case"removeDates":case"getDates":case"gotDate":case"sumDays":case"compareDates":case"dateConvert":case"value":l=i}return i}return"object"!=typeof t&&t?(e.error("Method "+t+" does not exist on jQuery.multiDatesPicker"),!1):u.init.apply(this,o)}),l};var t=(new Date).getTime();e.multiDatesPicker={version:!1},e.multiDatesPicker.initialized=!1,e.multiDatesPicker.uuid=(new Date).getTime(),e.multiDatesPicker.version=e.ui.multiDatesPicker.version,e.multiDatesPicker._hideDatepicker=e.datepicker._hideDatepicker,e.datepicker._hideDatepicker=function(){var t=this._curInst.input[0],a=t.multiDatesPicker;return!a||this._curInst.inline===!1&&!a.changed?e.multiDatesPicker._hideDatepicker.apply(this,arguments):(a.changed=!1,void e.datepicker._refreshDatepicker(t))},window["DP_jQuery_"+t]=e}(jQuery),$(function(){$(".ui.open-menu").on("click",function(){$(".ui.sidebar").sidebar("toggle")}),$(".help-text").popup(),$(".message .close").on("click",function(){$(this).closest(".message").transition("fade")}),$(".ui.accordion").accordion(),$(".ui.dropdown").dropdown({transition:"drop"}),$("table").tablesort(),$(".ui.calendar").calendar({type:"date",formatter:{date:function(e,t){if(!e)return"";var a=e.getDate(),i=e.getMonth()+1,n=e.getFullYear();return i<10&&(i="0"+i),a<10&&(a="0"+a),
n+"-"+i+"-"+a}}})}),$(function(){$(".ui.dropdown.maindish.selection").dropdown("setting","onChange",function(e,t,a){$url=$(".field.dish.selection").data("url"),window.location.replace($url+e)})}),$(function(){function e(e,t,a){selector=".ui.accordion.meals."+e,$(selector).show()}function t(){var t=$("#form-meals-schedule select[multiple='multiple']").val();t&&t.forEach(e)}function a(){$(".ui.accordion.meals").not(".default").each(function(){$(this).hide()})}$(".ui.dropdown.member.status > .menu > .item").click(function(){var e=$(this).data("value"),t=new Date,a=$(".ui.dropdown.status").attr("data-url");$.get(a,{status:e},function(e,a){$(".ui.modal.status").html(e).modal("setting",{closable:!1,onVisible:function(){$(".ui.status_to.dropdown").dropdown(),$("#rangestart").calendar({type:"date",on:"click",minDate:new Date(t.getFullYear(),t.getMonth(),t.getDate()),formatter:{date:function(e,t){if(!e)return"";var a=e.getDate(),i=e.getMonth()+1,n=e.getFullYear();return i<10&&(i="0"+i),a<10&&(a="0"+a),n+"-"+i+"-"+a}},endCalendar:$("#rangeend")}),$("#rangeend").calendar({type:"date",formatter:{date:function(e,t){if(!e)return"";var a=e.getDate(),i=e.getMonth()+1,n=e.getFullYear();return i<10&&(i="0"+i),a<10&&(a="0"+a),n+"-"+i+"-"+a}},startCalendar:$("#rangestart")})},onApprove:function(e,t){$.ajax({type:"POST",url:$(".ui.dropdown.status").attr("data-url"),data:$("#change-status-form").serialize(),success:function(e,t,a){$(e).find(".errorlist").length>0?($(".ui.modal.status").html(e),$(".ui.modal.status").modal("show")):location.reload()}})},onDeny:function(e){$(".ui.dropdown.status").dropdown("restore defaults")}}).modal("show")})}),"E"==$("#dietary_restriction-delivery_type select").val()?($("#form-meals-schedule").hide(),a()):($("#form-meals-schedule").show(),t()),$("#dietary_restriction-delivery_type .dropdown").dropdown("setting","onChange",function(e,i,n){"E"==n.data("value")?($("#form-meals-schedule").hide(),a()):($("#form-meals-schedule").show(),t())});var i=$("#id_payment_information-same_as_client");i&&i.checked&&$("#billing_select_member").hide(),$("#id_payment_information-same_as_client").on("change",function(){this.checked?$("#billing_select_member").hide():$("#billing_select_member").show()}),$(".ui.button.add.member").on("click",function(){$(".existing--member").val("").attr("disabled","disabled"),$(this).transition("scale"),$(".ui.add.form.member").transition("scale")}),$(".ui.button.cancel.add.member").on("click",function(){$(".ui.button.add.member").transition("scale"),$(".existing--member").removeAttr("disabled")}),(""!==$(".firstname").val()||""!==$(".lastname").val()&&""===$(".existing--member").val())&&($(".ui.button.add.member").transition("scale"),$(".existing--member").attr("disabled","disabled"),$(".ui.add.form.member").transition("scale")),$search_url=$(".ui.search").attr("data-url"),$(".ui.search").search({apiSettings:{cache:"local",url:$search_url+"?name={query}"},minCharacters:3}),$("#form-meals-schedule select[multiple='multiple']").change(function(){a(),t()});var n=$("#id_dietary_restriction-delivery_type, #id_delivery_type");n.change(function(){"E"==$(this).val()?($("#form-meals-schedule").hide(),a(),$(".ui.accordion.meals.default").show()):($("#form-meals-schedule").show(),t(),$(".ui.accordion.meals.default").hide())}),"E"==n.val()?($("#form-meals-schedule").hide(),a(),$(".ui.accordion.meals.default").show()):($("#form-meals-schedule").show(),t(),$(".ui.accordion.meals.default").hide())}),$(function(){$(".order-delete").click(function(){var e=$(this).attr("data-order-id"),t=".ui.basic.modal.order-"+e;$(t).modal("show")}),$(".ui.dropdown.order.status .menu > .item").click(function(){$(".ui.dropdown.order.status").addClass("loading"),$.ajax({url:$(".ui.dropdown.order.status").attr("data-url"),type:"POST",data:{status:$(this).data("value"),csrfmiddlewaretoken:$(".ui.dropdown.order.status").attr("data-csrf-token")},success:function(e){$(".ui.dropdown.order.status").removeClass("loading")}})}),$("#delivery_dates").multiDatesPicker({dateFormat:"yy-mm-dd",separator:"|",minDate:0,numberOfMonths:2,altField:"#id_delivery_dates"}),$("#id_delivery_dates").hide(),$("#id_client").change(function(){$.get("/member/client/"+$(this).val()+"/meals/preferences",function(e){$.isEmptyObject(e)?($("#id_main_dish_default_quantity").val(""),$("#id_size_default").val(""),$("#id_dessert_default_quantity").val(""),$("#id_diabetic_default_quantity").val(""),$("#id_fruit_salad_default_quantity").val(""),$("#id_green_salad_default_quantity").val(""),$("#id_pudding_default_quantity").val(""),$("#id_compote_default_quantity").val("")):($("#id_main_dish_default_quantity").val(e.maindish_q),$("#id_size_default").dropdown("set selected",e.maindish_s),$("#id_dessert_default_quantity").val(e.dst_q),$("#id_diabetic_default_quantity").val(e.diabdst_q),$("#id_fruit_salad_default_quantity").val(e.fruitsld_q),$("#id_green_salad_default_quantity").val(e.greensld_q),$("#id_pudding_default_quantity").val(e.pudding_q),$("#id_compote_default_quantity").val(e.compot_q))})})}),$(function(){$(".billing-delete").click(function(){var e=$(this).attr("data-billing-id"),t=".ui.basic.modal.billing-"+e;$(t).modal("show")}),$("#billing_delivery_date").calendar({type:"month",formatter:{date:function(e,t){if(!e)return"";var a=e.getMonth()+1,i=e.getFullYear();return a<10&&(a="0"+a),i+"-"+a}}}),$(".add.icon").popup()}),$(function(){$(".ui.large.form").form({on:"submit",revalidate:"false",fields:{username:{identifier:"username",rules:[{type:"empty",prompt:"Please enter a username"}]},password:{identifier:"password",rules:[{type:"empty",prompt:"Please enter a password"},{type:"minLength[6]",prompt:"Your password must be at least {ruleValue} characters"}]}}})});